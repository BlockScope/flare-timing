<!-- saved from url=(0052)http://www.stevemorse.org/nearest/distancebatch.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <title>Batch Distance Computations based on Latitude/Longitude</title>
    <script src="./Vincenty/vincenty.js"> </script>
    <script src="./Vicenty/email.js"></script>

    <script>

      var outputLine = "";

      function FlushOutput() {
        document.form.database.value = outputLine;
        outputLine = "";
      }

      function Compute() {
        var text = document.form.rawdatabase.value;
        
        if (text.length == 0) {
          alert ("Nothing to process");
          return;
        }
        var lines = text.split('\n');
        for (var i=0; i<lines.length; i++) {
          var line = lines[i];
          // strip spaces from either end of line
          while (line.charAt(0) == " ") {
            line = line.substr(1);
          }
          var length = line.length;
          while (line.charAt(--length) == " ") {
            line = line.substr(0,length);
          }

          // clean up line a little more
          if (line.length == 0 && i == lines.length-1) {
            break;
          }
          if (line.charAt(line.length-1) == '\r') {
            line = line.substr(0,line.length-1);
          }

          // parse the line
          latlonArray = line.split(",");
          lat1 = latlonArray[0];
          lon1 = latlonArray[1];
          lat2 = latlonArray[2];
          lon2 = latlonArray[3];

          if (lat1 > 90) {
            lat1 = 90;
          } else if (lat1 < -90) {
            lat1 = -90;
          }
          if (lon1 > 180) {
            lon1 = 180;
          } else if (lon1 < -180) {
            lon1 = -180;
          }
          if (lat2 > 90) {
            lat2 = 90;
          } else if (lat2 < -90) {
            lat2 = -90;
          }
          if (lon2 > 180) {
            lon2 = 180;
          } else if (lon2 < -180) {
            lon2 = -180;
          }

          // get the distance

          var meters = distVincenty(lat1-0, lon1-0, lat2-0, lon2-0);
          var kilometers = meters / 1000; // converts meters to kilometers
          var statute = meters * 0.000621371192; // converts meters to statute miles
          var nautical = 0.86897624 * statute; // converts miles to nautical miles

          for (var j=0; j<document.form.units.length; j++) {
            if (document.form.units[j].value == "kilometers" && document.form.units[j].checked) {
              outputLine = outputLine + kilometers + "\n";
              break;
            } else if (document.form.units[j].value == "statute" && document.form.units[j].checked) {
              outputLine = outputLine + statute + "\n";
              break;
            } else if (document.form.units[j].value == "nautical" && document.form.units[j].checked) {
              outputLine = outputLine + nautical + "\n";
              break;
            }
          }
        }
        FlushOutput();
      }

      function clear() {
        document.form.database.value =
          "Do not enter anything here\n" +
          "Use the left-side box";
        document.form.rawdatabase.value = "";
      }

    </script>
  </head>

  <body onload="clear();">
    <form name="form">
      <center>
        <font size="5">
          Batch Distance Computations based on Latitude/Longitude in One Step
        </font>
        <br>
        <font size="4">
          <script>emailhref()</script><a href="mailto:steve@stevemorse.org">Stephen P. Morse</a>, San Francisco
        </font>
        <br><br>
        <input type="button" value="Interactive Mode" onclick="window.location=&#39;http://stevemorse.org/nearest/distance.php&#39;">
<!--
        <input type="button" value="Frequently Asked Questions" onclick="window.location='faq.htm'">
-->
        <input type="button" value="My Other Webpages" onclick="window.location=&#39;../index.html&#39;">
        <br><br>
        <b>Type in or Copy-and-Paste Latitude/Longitude pairs into the left box below and then click </b>
        <input type="button" value="Process" onclick="Compute();">
        <br>
        Format is latitude1, longitude1, latitude2, longitude2 -- all in decimal notation
        <br>
        Results are in
        <input type="radio" name="units" value="statute" checked=""> statute miles
        <input type="radio" name="units" value="nautical"> nautical miles
        <input type="radio" name="units" value="kilometers"> kilometers
        <br>
        <textarea name="rawdatabase" rows="20" cols="35" wrap="off">        </textarea>
        <textarea name="database" rows="20" cols="35" wrap="off">        </textarea>
      </center>
      <br><br>
      <font size="2">
        Distance calculations are based on an ellipsoidal earth using the formula developed by
          <a href="http://www.movable-type.co.uk/scripts/latlong-vincenty.html" target="_blank">Thaddeus Vincenty</a>
        <br><br>
        © Stephen P. Morse, 2011
      </font>
      <br><a href="http://stevemorse.org/" target="_top"><img src="./Batch Distance Computations based on Latitude_Longitude_files/favicon.jpg"></a>
    </form>
  


</body></html>
